version: '3.8'

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: recipe-backend
    restart: unless-stopped
    environment:
      NODE_ENV: ${NODE_ENV:-production}
      PORT: ${PORT:-8081}
      WEBSOCKET_PORT: ${WEBSOCKET_PORT:-8083}
      WEBSOCKET_PATH: ${WEBSOCKET_PATH:-/socket.io}
      ELASTICSEARCH_URL: ${ELASTICSEARCH_URL}
      OLLAMA_URL: ${OLLAMA_URL}
      OLLAMA_MODEL: ${OLLAMA_MODEL}
      OLLAMA_TEMPERATURE_GENERATION: ${OLLAMA_TEMPERATURE_GENERATION}
      OLLAMA_TEMPERATURE_CLASSIFICATION: ${OLLAMA_TEMPERATURE_CLASSIFICATION}
      OLLAMA_MAX_TOKENS: ${OLLAMA_MAX_TOKENS}
    expose:
      - "8081"
      - "8083"
    networks:
      - recipe-network

networks:
  recipe-network:
    external: true
